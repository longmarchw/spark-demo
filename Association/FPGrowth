%livy.spark

//算法名称-FPGrowth

import java.util
import cn.neucloud.dasuan.analysis.fpgrowth.FPGrowth
import org.apache.spark.api.java.JavaSparkContext
import org.apache.spark.mllib.fpm.FPGrowthModel
import org.apache.spark. SparkConf

//spark上下文准备
val conf = new SparkConf().setAppName("testFPG").setMaster("local[5]")
val jsc = JavaSparkContext.fromSparkContext(sc)
//准备数据
val data = jsc.parallelize(
  util.Arrays.asList(
	"r z h k p".split(" "),
	"z y x w v u t s".split(" "),
	"s x o n r".split(" "),
	"x z y m t s q e".split(" "),
	"z".split(" "),
	"x z y r q t p".split(" ")
  )
)
val fpg: FPGrowth = new FPGrowth(jsc)
//应用算法
val model: FPGrowthModel[String] = fpg.fpGrowth(data,10,0.2)
fpg.printFreqItem(model)
fpg.printGenerateAssociation(model,0.8)

